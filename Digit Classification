{"cells":[{"source":"<a href=\"https://www.kaggle.com/mohaliy2016/digit-classification?scriptVersionId=88731268\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown","outputs":[],"execution_count":0},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.014939,"end_time":"2022-02-25T14:50:18.015592","exception":false,"start_time":"2022-02-25T14:50:18.000653","status":"completed"},"tags":[]},"source":["# Classification of digits using simple CNN and GPU accelerator "]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.015663,"end_time":"2022-02-25T14:50:18.048581","exception":false,"start_time":"2022-02-25T14:50:18.032918","status":"completed"},"tags":[]},"source":["## Dictionary that contains some important variables\n"]},{"cell_type":"code","execution_count":1,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T14:50:18.083869Z","iopub.status.busy":"2022-02-25T14:50:18.081941Z","iopub.status.idle":"2022-02-25T14:50:18.084586Z","shell.execute_reply":"2022-02-25T14:50:18.085078Z"},"papermill":{"duration":0.023245,"end_time":"2022-02-25T14:50:18.08524","exception":false,"start_time":"2022-02-25T14:50:18.061995","status":"completed"},"tags":[]},"outputs":[],"source":["cfg = dict(\n","    batch_size        =  16,\n","     \n","    \n","    LR_START          = 0.000005,\n","    LR_MAX            = 0.000020,\n","    LR_MIN            = 0.000001,\n","    LR_RAMPUP_EPOCHS  =  5,\n","    LR_SUSTAIN_EPOCHS =  0,\n","    LR_EXP_DECAY      =  0.8,\n","    epochs            =  50,\n","\n","    optimizer         = 'Adam',\n","    label_smooth_fac  = 0.05\n",")"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.01402,"end_time":"2022-02-25T14:50:18.113937","exception":false,"start_time":"2022-02-25T14:50:18.099917","status":"completed"},"tags":[]},"source":["## Libraries  ..."]},{"cell_type":"code","execution_count":2,"metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2022-02-25T14:50:18.157927Z","iopub.status.busy":"2022-02-25T14:50:18.157146Z","iopub.status.idle":"2022-02-25T14:50:18.914206Z","shell.execute_reply":"2022-02-25T14:50:18.914625Z"},"papermill":{"duration":0.786685,"end_time":"2022-02-25T14:50:18.914778","exception":false,"start_time":"2022-02-25T14:50:18.128093","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["Using TensorFlow backend.\n"]}],"source":["import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","import matplotlib.image as mpimg\n","import seaborn as sns\n","%matplotlib inline\n","import os\n","import tensorflow as tf\n","\n","np.random.seed(2)\n","\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import confusion_matrix\n","import itertools\n","\n","from keras.utils.np_utils import to_categorical # convert to one-hot-encoding\n","from keras.models import Sequential\n","from keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPool2D, ZeroPadding2D\n","from keras.optimizers import RMSprop\n","from keras.preprocessing.image import ImageDataGenerator\n","from keras.callbacks import ReduceLROnPlateau\n","from tensorflow.keras.layers import BatchNormalization, Conv2D , MaxPooling2D , Dense, Flatten, Dropout, Input\n","from tqdm.keras import TqdmCallback\n","\n","from tqdm import tqdm\n","import tensorflow.keras.backend as K\n","from sklearn.utils.class_weight import compute_class_weight\n","sns.set(style='white', context='notebook', palette='deep')\n","\n","from keras.models import Model\n","from keras import regularizers"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.01367,"end_time":"2022-02-25T14:50:18.942237","exception":false,"start_time":"2022-02-25T14:50:18.928567","status":"completed"},"tags":[]},"source":["## Load data ..."]},{"cell_type":"code","execution_count":3,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T14:50:18.978989Z","iopub.status.busy":"2022-02-25T14:50:18.978424Z","iopub.status.idle":"2022-02-25T14:50:24.186218Z","shell.execute_reply":"2022-02-25T14:50:24.185128Z"},"papermill":{"duration":5.230562,"end_time":"2022-02-25T14:50:24.18635","exception":false,"start_time":"2022-02-25T14:50:18.955788","status":"completed"},"tags":[]},"outputs":[],"source":["topDir = '/kaggle' \n","os.chdir(topDir)\n","train = pd.read_csv(os.path.join(topDir, 'input/digit-recognizer/train.csv'))\n","test = pd.read_csv(os.path.join(topDir, 'input/digit-recognizer/test.csv'))\n","submission_path = os.path.join(topDir, 'working/submission.csv')\n","y_train = train['label']\n","x_train = train.drop(labels = [\"label\"],axis = 1)\n","del train"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.01414,"end_time":"2022-02-25T14:50:24.214794","exception":false,"start_time":"2022-02-25T14:50:24.200654","status":"completed"},"tags":[]},"source":["## Distribution plot ..."]},{"cell_type":"code","execution_count":4,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T14:50:24.245913Z","iopub.status.busy":"2022-02-25T14:50:24.245359Z","iopub.status.idle":"2022-02-25T14:50:24.466338Z","shell.execute_reply":"2022-02-25T14:50:24.46543Z"},"papermill":{"duration":0.238132,"end_time":"2022-02-25T14:50:24.466437","exception":false,"start_time":"2022-02-25T14:50:24.228305","status":"completed"},"tags":[]},"outputs":[{"data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["g = sns.countplot(y_train)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.014414,"end_time":"2022-02-25T14:50:24.495524","exception":false,"start_time":"2022-02-25T14:50:24.48111","status":"completed"},"tags":[]},"source":["## Data preprocessing "]},{"cell_type":"code","execution_count":5,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T14:50:24.531172Z","iopub.status.busy":"2022-02-25T14:50:24.530387Z","iopub.status.idle":"2022-02-25T14:50:25.069366Z","shell.execute_reply":"2022-02-25T14:50:25.068764Z"},"papermill":{"duration":0.559193,"end_time":"2022-02-25T14:50:25.069484","exception":false,"start_time":"2022-02-25T14:50:24.510291","status":"completed"},"tags":[]},"outputs":[],"source":["# Normalizing\n","x_train = x_train / 255.0\n","test = test / 255.0\n","\n","# Reshape image in 3 dimensions (height = 28px, width = 28px , canal = 1)\n","x_train = x_train.values.reshape(-1,28,28,1)\n","test = test.values.reshape(-1,28,28,1)\n","\n","# Encode labels to one hot vectors (ex : 2 -> [0,0,1,0,0,0,0,0,0,0])\n","y_train = to_categorical(y_train, num_classes = 10)\n","\n","# Spliting the data into training and validation sets\n","random_seed = 2\n","x_train, x_val, y_train, y_val = train_test_split(x_train, y_train, test_size = 0.2, random_state=random_seed)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.014349,"end_time":"2022-02-25T14:50:25.098626","exception":false,"start_time":"2022-02-25T14:50:25.084277","status":"completed"},"tags":[]},"source":["## Accelerator initialization ..."]},{"cell_type":"code","execution_count":6,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T14:50:25.137063Z","iopub.status.busy":"2022-02-25T14:50:25.136466Z","iopub.status.idle":"2022-02-25T14:50:25.613175Z","shell.execute_reply":"2022-02-25T14:50:25.612656Z"},"papermill":{"duration":0.500316,"end_time":"2022-02-25T14:50:25.613288","exception":false,"start_time":"2022-02-25T14:50:25.112972","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Using default strategy for CPU and single GPU\n","Num GPUs Available:  1\n","REPLICAS:  1\n"]}],"source":["DEVICE = \"GPU\"\n","if DEVICE == \"TPU\":\n","    print(\"connecting to TPU...\")\n","    try:\n","        tpu = tf.distribute.cluster_resolver.TPUClusterResolver()  # TPU detection. No parameters necessary if TPU_NAME environment variable is set. On Kaggle this is always the case.\n","        print('Running on TPU ', tpu.master())\n","    except ValueError:\n","        print(\"Could not connect to TPU\")\n","        tpu = None\n","\n","    if tpu:\n","        try:\n","            print(\"initializing  TPU ...\")\n","            tf.config.experimental_connect_to_cluster(tpu)\n","            tf.tpu.experimental.initialize_tpu_system(tpu)\n","            strategy = tf.distribute.experimental.TPUStrategy(tpu)\n","            print(\"TPU initialized\")\n","        except _:\n","            print(\"failed to initialize TPU\")\n","    else:\n","        DEVICE = \"GPU\"\n","\n","if DEVICE != \"TPU\":\n","    print(\"Using default strategy for CPU and single GPU\")\n","    strategy = tf.distribute.get_strategy()\n","\n","if DEVICE == \"GPU\":\n","    print(\"Num GPUs Available: \", len(tf.config.experimental.list_physical_devices('GPU')))\n","    \n","print(\"REPLICAS: \", strategy.num_replicas_in_sync)\n","AUTO = tf.data.experimental.AUTOTUNE"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.023761,"end_time":"2022-02-25T14:50:25.666385","exception":false,"start_time":"2022-02-25T14:50:25.642624","status":"completed"},"tags":[]},"source":["## Function monitors and changes the learning rate ..."]},{"cell_type":"code","execution_count":7,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T14:50:25.747799Z","iopub.status.busy":"2022-02-25T14:50:25.746982Z","iopub.status.idle":"2022-02-25T14:50:25.753188Z","shell.execute_reply":"2022-02-25T14:50:25.754254Z"},"papermill":{"duration":0.047072,"end_time":"2022-02-25T14:50:25.754422","exception":false,"start_time":"2022-02-25T14:50:25.70735","status":"completed"},"tags":[]},"outputs":[],"source":["def getLearnRateCallback(cfg):\n","    LR_START = cfg[\"LR_START\"]\n","    LR_MAX = cfg[\"LR_MAX\"] * strategy.num_replicas_in_sync\n","    LR_MIN = cfg[\"LR_MIN\"]\n","    LR_RAMPUP_EPOCHS = cfg[\"LR_RAMPUP_EPOCHS\"]\n","    LR_SUSTAIN_EPOCHS = cfg[\"LR_SUSTAIN_EPOCHS\"]\n","    LR_EXP_DECAY = cfg[\"LR_EXP_DECAY\"]\n","   \n","    def lrfn(epoch):\n","        if epoch < LR_RAMPUP_EPOCHS:\n","            lr = (LR_MAX - LR_START) / LR_RAMPUP_EPOCHS * epoch + LR_START\n","        elif epoch < LR_RAMPUP_EPOCHS + LR_SUSTAIN_EPOCHS:\n","            lr = LR_MAX\n","        else:\n","            lr = (LR_MAX - LR_MIN) * LR_EXP_DECAY**(epoch - LR_RAMPUP_EPOCHS - LR_SUSTAIN_EPOCHS) + LR_MIN\n","        return lr\n","\n","    lr_callback = tf.keras.callbacks.LearningRateScheduler(lrfn, verbose=False)\n","    return lr_callback"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.024244,"end_time":"2022-02-25T14:50:25.803144","exception":false,"start_time":"2022-02-25T14:50:25.7789","status":"completed"},"tags":[]},"source":["## Sequential model "]},{"cell_type":"code","execution_count":8,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T14:50:25.865947Z","iopub.status.busy":"2022-02-25T14:50:25.860117Z","iopub.status.idle":"2022-02-25T14:50:28.002849Z","shell.execute_reply":"2022-02-25T14:50:28.001858Z"},"papermill":{"duration":2.175621,"end_time":"2022-02-25T14:50:28.003004","exception":false,"start_time":"2022-02-25T14:50:25.827383","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Model: \"model\"\n","_________________________________________________________________\n","Layer (type)                 Output Shape              Param #   \n","=================================================================\n","input_1 (InputLayer)         [(None, 28, 28, 1)]       0         \n","_________________________________________________________________\n","conv2d (Conv2D)              (None, 26, 26, 16)        160       \n","_________________________________________________________________\n","conv2d_1 (Conv2D)            (None, 24, 24, 16)        2320      \n","_________________________________________________________________\n","batch_normalization (BatchNo (None, 24, 24, 16)        64        \n","_________________________________________________________________\n","zero_padding2d (ZeroPadding2 (None, 26, 26, 16)        0         \n","_________________________________________________________________\n","conv2d_2 (Conv2D)            (None, 24, 24, 32)        4640      \n","_________________________________________________________________\n","conv2d_3 (Conv2D)            (None, 22, 22, 32)        9248      \n","_________________________________________________________________\n","batch_normalization_1 (Batch (None, 22, 22, 32)        128       \n","_________________________________________________________________\n","conv2d_4 (Conv2D)            (None, 20, 20, 64)        18496     \n","_________________________________________________________________\n","conv2d_5 (Conv2D)            (None, 18, 18, 64)        36928     \n","_________________________________________________________________\n","batch_normalization_2 (Batch (None, 18, 18, 64)        256       \n","_________________________________________________________________\n","max_pooling2d (MaxPooling2D) (None, 9, 9, 64)          0         \n","_________________________________________________________________\n","conv2d_6 (Conv2D)            (None, 9, 9, 128)         8320      \n","_________________________________________________________________\n","conv2d_7 (Conv2D)            (None, 9, 9, 128)         16512     \n","_________________________________________________________________\n","batch_normalization_3 (Batch (None, 9, 9, 128)         512       \n","_________________________________________________________________\n","flatten (Flatten)            (None, 10368)             0         \n","_________________________________________________________________\n","dense (Dense)                (None, 1024)              10617856  \n","_________________________________________________________________\n","dropout (Dropout)            (None, 1024)              0         \n","_________________________________________________________________\n","dense_1 (Dense)              (None, 512)               524800    \n","_________________________________________________________________\n","dropout_1 (Dropout)          (None, 512)               0         \n","_________________________________________________________________\n","dense_2 (Dense)              (None, 10)                5130      \n","=================================================================\n","Total params: 11,245,370\n","Trainable params: 11,244,890\n","Non-trainable params: 480\n","_________________________________________________________________\n"]}],"source":["with strategy.scope():\n","    visible = Input(shape=(28,28,1))\n","    conv1 = Conv2D(16, kernel_size=(3,3), activation='relu',strides=(1,1))(visible)\n","    conv2 = Conv2D(16, kernel_size=(3,3), activation='relu',strides=(1,1))(conv1)\n","    bat1 = BatchNormalization()(conv2)\n","    zero1 = ZeroPadding2D(padding=(1,1))(bat1)\n","\n","    conv3 = Conv2D(32, kernel_size=(3,3), activation='relu', padding = 'valid', kernel_regularizer=regularizers.l2(0.02))(zero1)\n","    conv4 = Conv2D(32, kernel_size=(3,3), activation='relu', padding = 'valid', kernel_regularizer=regularizers.l2(0.02))(conv3)\n","    bat2 = BatchNormalization()(conv4)\n","\n","\n","    conv5 = Conv2D(64, kernel_size=(3,3), activation='relu',strides=(1,1), padding = 'valid')(bat2)\n","    conv6 = Conv2D(64, kernel_size=(3,3), activation='relu',strides=(1,1), padding = 'valid')(conv5)\n","    bat3 = BatchNormalization()(conv6)\n","    pool1 = MaxPooling2D(pool_size=(2,2))(bat3)\n","    zero2 = ZeroPadding2D(padding=(1,1))(pool1)\n","\n","    conv7 = Conv2D(128, kernel_size=(1,1), activation='relu', padding = 'valid', kernel_regularizer=regularizers.l2(0.05))(pool1)\n","    conv8 = Conv2D(128, kernel_size=(1,1), activation='relu', padding = 'valid', strides=(1,1))(conv7)\n","    bat4 = BatchNormalization()(conv8)\n","\n","    flat = Flatten()(bat4)\n","    hidden1 = Dense(1024, activation='relu')(flat)\n","    drop1 = Dropout(0.5)(hidden1)\n","\n","    hidden2 = Dense(512, activation='relu')(drop1)\n","    drop2 = Dropout(0.5)(hidden2)\n","\n","    output = Dense(10,activation = 'softmax')(drop2)\n","\n","    model = Model(inputs=visible, outputs = output)\n","    model.summary()"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.015715,"end_time":"2022-02-25T14:50:28.035413","exception":false,"start_time":"2022-02-25T14:50:28.019698","status":"completed"},"tags":[]},"source":["## Model compilation ..."]},{"cell_type":"code","execution_count":9,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T14:50:28.076901Z","iopub.status.busy":"2022-02-25T14:50:28.076067Z","iopub.status.idle":"2022-02-25T14:50:28.092165Z","shell.execute_reply":"2022-02-25T14:50:28.091711Z"},"papermill":{"duration":0.041135,"end_time":"2022-02-25T14:50:28.092256","exception":false,"start_time":"2022-02-25T14:50:28.051121","status":"completed"},"tags":[]},"outputs":[],"source":["with strategy.scope():    \n","    model.compile(\n","        optimizer = cfg[\"optimizer\"],\n","        loss = [tf.keras.losses.CategoricalCrossentropy(label_smoothing = cfg[\"label_smooth_fac\"])],\n","        metrics=[tf.keras.metrics.AUC(name='auc')]           \n","    )"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":0.015577,"end_time":"2022-02-25T14:50:28.123626","exception":false,"start_time":"2022-02-25T14:50:28.108049","status":"completed"},"tags":[]},"source":["## Model training ... "]},{"cell_type":"code","execution_count":10,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T14:50:28.161992Z","iopub.status.busy":"2022-02-25T14:50:28.16098Z","iopub.status.idle":"2022-02-25T15:02:35.904755Z","shell.execute_reply":"2022-02-25T15:02:35.903517Z"},"papermill":{"duration":727.765528,"end_time":"2022-02-25T15:02:35.904943","exception":false,"start_time":"2022-02-25T14:50:28.139415","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Epoch 1/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 6.8633 - auc: 0.8875 - val_loss: 5.8267 - val_auc: 0.9939 - lr: 5.0000e-06\n","Epoch 2/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 5.8347 - auc: 0.9848 - val_loss: 5.3989 - val_auc: 0.9977 - lr: 8.0000e-06\n","Epoch 3/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 5.2255 - auc: 0.9945 - val_loss: 4.7942 - val_auc: 0.9989 - lr: 1.1000e-05\n","Epoch 4/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 4.4787 - auc: 0.9979 - val_loss: 4.0094 - val_auc: 0.9995 - lr: 1.4000e-05\n","Epoch 5/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 3.6350 - auc: 0.9990 - val_loss: 3.1655 - val_auc: 0.9996 - lr: 1.7000e-05\n","Epoch 6/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 2.8056 - auc: 0.9995 - val_loss: 2.3902 - val_auc: 0.9997 - lr: 2.0000e-05\n","Epoch 7/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 2.1787 - auc: 0.9997 - val_loss: 1.9206 - val_auc: 0.9997 - lr: 1.6200e-05\n","Epoch 8/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 1.7918 - auc: 0.9999 - val_loss: 1.6244 - val_auc: 0.9997 - lr: 1.3160e-05\n","Epoch 9/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 1.5396 - auc: 0.9999 - val_loss: 1.4261 - val_auc: 0.9999 - lr: 1.0728e-05\n","Epoch 10/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 1.3701 - auc: 0.9999 - val_loss: 1.2881 - val_auc: 0.9998 - lr: 8.7824e-06\n","Epoch 11/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 1.2483 - auc: 1.0000 - val_loss: 1.1893 - val_auc: 0.9998 - lr: 7.2259e-06\n","Epoch 12/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 1.1580 - auc: 1.0000 - val_loss: 1.1149 - val_auc: 0.9999 - lr: 5.9807e-06\n","Epoch 13/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 1.0889 - auc: 1.0000 - val_loss: 1.0564 - val_auc: 0.9998 - lr: 4.9846e-06\n","Epoch 14/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 1.0363 - auc: 1.0000 - val_loss: 1.0115 - val_auc: 0.9999 - lr: 4.1877e-06\n","Epoch 15/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.9946 - auc: 1.0000 - val_loss: 0.9768 - val_auc: 0.9998 - lr: 3.5501e-06\n","Epoch 16/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.9609 - auc: 1.0000 - val_loss: 0.9475 - val_auc: 0.9998 - lr: 3.0401e-06\n","Epoch 17/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.9332 - auc: 1.0000 - val_loss: 0.9228 - val_auc: 0.9999 - lr: 2.6321e-06\n","Epoch 18/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.9099 - auc: 1.0000 - val_loss: 0.9018 - val_auc: 0.9999 - lr: 2.3057e-06\n","Epoch 19/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.8900 - auc: 1.0000 - val_loss: 0.8843 - val_auc: 0.9999 - lr: 2.0445e-06\n","Epoch 20/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.8734 - auc: 1.0000 - val_loss: 0.8690 - val_auc: 0.9999 - lr: 1.8356e-06\n","Epoch 21/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.8586 - auc: 1.0000 - val_loss: 0.8554 - val_auc: 0.9999 - lr: 1.6685e-06\n","Epoch 22/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.8452 - auc: 1.0000 - val_loss: 0.8434 - val_auc: 0.9999 - lr: 1.5348e-06\n","Epoch 23/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.8333 - auc: 1.0000 - val_loss: 0.8326 - val_auc: 0.9999 - lr: 1.4278e-06\n","Epoch 24/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.8219 - auc: 1.0000 - val_loss: 0.8233 - val_auc: 0.9999 - lr: 1.3423e-06\n","Epoch 25/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.8118 - auc: 1.0000 - val_loss: 0.8128 - val_auc: 0.9999 - lr: 1.2738e-06\n","Epoch 26/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.8022 - auc: 1.0000 - val_loss: 0.8042 - val_auc: 0.9999 - lr: 1.2191e-06\n","Epoch 27/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.7938 - auc: 1.0000 - val_loss: 0.7955 - val_auc: 0.9999 - lr: 1.1752e-06\n","Epoch 28/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.7846 - auc: 1.0000 - val_loss: 0.7876 - val_auc: 0.9999 - lr: 1.1402e-06\n","Epoch 29/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.7765 - auc: 1.0000 - val_loss: 0.7796 - val_auc: 0.9999 - lr: 1.1122e-06\n","Epoch 30/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.7690 - auc: 1.0000 - val_loss: 0.7725 - val_auc: 0.9999 - lr: 1.0897e-06\n","Epoch 31/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.7618 - auc: 1.0000 - val_loss: 0.7658 - val_auc: 0.9999 - lr: 1.0718e-06\n","Epoch 32/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.7542 - auc: 1.0000 - val_loss: 0.7590 - val_auc: 0.9999 - lr: 1.0574e-06\n","Epoch 33/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.7477 - auc: 1.0000 - val_loss: 0.7519 - val_auc: 0.9999 - lr: 1.0459e-06\n","Epoch 34/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.7407 - auc: 1.0000 - val_loss: 0.7458 - val_auc: 0.9998 - lr: 1.0368e-06\n","Epoch 35/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.7336 - auc: 1.0000 - val_loss: 0.7394 - val_auc: 0.9999 - lr: 1.0294e-06\n","Epoch 36/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.7276 - auc: 1.0000 - val_loss: 0.7333 - val_auc: 0.9999 - lr: 1.0235e-06\n","Epoch 37/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.7212 - auc: 1.0000 - val_loss: 0.7275 - val_auc: 0.9999 - lr: 1.0188e-06\n","Epoch 38/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.7152 - auc: 1.0000 - val_loss: 0.7220 - val_auc: 0.9999 - lr: 1.0151e-06\n","Epoch 39/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.7091 - auc: 1.0000 - val_loss: 0.7148 - val_auc: 0.9999 - lr: 1.0120e-06\n","Epoch 40/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.7027 - auc: 1.0000 - val_loss: 0.7094 - val_auc: 0.9999 - lr: 1.0096e-06\n","Epoch 41/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.6974 - auc: 1.0000 - val_loss: 0.7042 - val_auc: 0.9998 - lr: 1.0077e-06\n","Epoch 42/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.6916 - auc: 1.0000 - val_loss: 0.6985 - val_auc: 0.9999 - lr: 1.0062e-06\n","Epoch 43/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.6857 - auc: 1.0000 - val_loss: 0.6935 - val_auc: 0.9999 - lr: 1.0049e-06\n","Epoch 44/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.6804 - auc: 1.0000 - val_loss: 0.6876 - val_auc: 0.9998 - lr: 1.0039e-06\n","Epoch 45/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.6749 - auc: 1.0000 - val_loss: 0.6825 - val_auc: 0.9999 - lr: 1.0032e-06\n","Epoch 46/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.6699 - auc: 1.0000 - val_loss: 0.6768 - val_auc: 0.9999 - lr: 1.0025e-06\n","Epoch 47/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.6642 - auc: 1.0000 - val_loss: 0.6723 - val_auc: 0.9999 - lr: 1.0020e-06\n","Epoch 48/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.6587 - auc: 1.0000 - val_loss: 0.6674 - val_auc: 0.9999 - lr: 1.0016e-06\n","Epoch 49/50\n","2100/2100 [==============================] - 15s 7ms/step - loss: 0.6542 - auc: 1.0000 - val_loss: 0.6625 - val_auc: 0.9999 - lr: 1.0013e-06\n","Epoch 50/50\n","2100/2100 [==============================] - 14s 7ms/step - loss: 0.6495 - auc: 1.0000 - val_loss: 0.6580 - val_auc: 0.9999 - lr: 1.0010e-06\n"]}],"source":["callbacks = [getLearnRateCallback(cfg)]\n","history = model.fit(x=x_train,\n","                    y=y_train,\n","                    batch_size=cfg['batch_size'],\n","                    epochs=cfg['epochs'],\n","                    validation_data=(x_val,y_val), \n","                    verbose = 1,\n","                    shuffle=True,\n","                    callbacks = callbacks)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":3.872031,"end_time":"2022-02-25T15:02:43.444595","exception":false,"start_time":"2022-02-25T15:02:39.572564","status":"completed"},"tags":[]},"source":["## Training progress plot ... "]},{"cell_type":"code","execution_count":11,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T15:02:50.76578Z","iopub.status.busy":"2022-02-25T15:02:50.764925Z","iopub.status.idle":"2022-02-25T15:02:51.230131Z","shell.execute_reply":"2022-02-25T15:02:51.230562Z"},"papermill":{"duration":4.357366,"end_time":"2022-02-25T15:02:51.230688","exception":false,"start_time":"2022-02-25T15:02:46.873322","status":"completed"},"tags":[]},"outputs":[{"data":{"image/png":"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LIwGDRo4prvW8tatW8fq1av57bffWLhwIX/729+IiIggPj7e0TEtXryYTz/9FLCXYRg/fjzBwcHXLSF9ufj4eH7//XcsFgvVq1dn8uTJ1KpVC4A1a9Ywc+ZMrFYrqqoyZcoUmjRpcs2y0I0bN2br1q34+tqrBVz6uHHjxvzzn/9k7dq1tGvXjm7dul3zfczNzWXy5MmkpKSgKArt27fn1Vdf5aGHHiIhIYHQUPs1xydOnEiNGjV49tlnb/kzd9vkHyBj/qIKOb36Z06tWl0hyw6LiSY0+oHrTuPh4eEoNvbqq6+Sl5fHTz/9xIoVK/D19eWLL77Aw8OD/Px8+vXrx/333++ouX81X3/9NceOHWPp0qVYrVYGDhzoOMu0Vq1aV13e/fffT3R0NC1atGDQoEGA/ddHsX379vHee+85kuH06dOZMGEC06dPB8peQnrYsGGOq4gtXLiQ9957j2nTpnH48GHGjh3L3LlzqVevHmazGbPZfM2y0GWhaZqj/HNeXt4138fJkyfj4+NDYmIiqqqSlZWFl5cXcXFxfPPNN7zwwgsUFBSwbNkyli5dWqZ1l8btkn9Onr3inr8M+whRwmOPPcbf//53XnrpJVasWEG7du0ICwsjMzOTd955h71796IoCqdPn2bPnj3XTf7JycmOmjYmk4levXqxdetWAAoLC294ecXL7Ny5s2Mr+IknniA2NtbxellLSP/yyy/MmzePgoKCEsMxv/32G506daJevXqAvUP08PDg559/vmpZ6LLo3bu34/712r1mzRoSEhJQVftIfHH554EDBzJgwACeffZZEhMTuffeewkOvv71yMvK7ZK/bPmLqig0+oFSt84rWpMmTQgJCWHdunV89913jiGJf//734SEhDBlyhSMRiNDhgy5ZhnnYtcrGXYzyyte5vVKPJelhPTx48d59913+fbbb4mMjGTr1q288sor1425tPLPxa9frQ2Xln++mXZHRETQsmVLVq1axbx58xg/fvx1p78RbrfDNye/eMtfkr8Ql+vbty8zZ87kyJEjREdHA/bx6PDwcIxGI/v27WPz5s2lLqdjx44kJiZitVopLCwsMVRxveX5+fmRm5t7zWWuXbvWcdnFb775hnvuueeG2peXl4fJZCIkJARN00oc4XTffffxyy+/OC4EYzabycvLu2ZZaLBX5ywu/5yUlHTddV+v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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["fig, ax = plt.subplots(2,1)\n","ax[0].plot(history.history['loss'], color='b', label=\"Training loss\")\n","ax[0].plot(history.history['val_loss'], color='r', label=\"validation loss\",axes =ax[0])\n","legend = ax[0].legend(loc='best', shadow=True)\n","\n","ax[1].plot(history.history['auc'], color='b', label=\"Training accuracy\")\n","ax[1].plot(history.history['val_auc'], color='r',label=\"Validation accuracy\")\n","legend = ax[1].legend(loc='best', shadow=True)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":3.512863,"end_time":"2022-02-25T15:02:58.174176","exception":false,"start_time":"2022-02-25T15:02:54.661313","status":"completed"},"tags":[]},"source":["## Confusion matrix  evaluation of the model on the validation set "]},{"cell_type":"code","execution_count":12,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T15:03:05.187662Z","iopub.status.busy":"2022-02-25T15:03:05.186571Z","iopub.status.idle":"2022-02-25T15:03:06.311376Z","shell.execute_reply":"2022-02-25T15:03:06.310873Z"},"papermill":{"duration":4.523963,"end_time":"2022-02-25T15:03:06.311484","exception":false,"start_time":"2022-02-25T15:03:01.787521","status":"completed"},"tags":[]},"outputs":[{"data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["#Function ...\n","def plot_confusion_matrix(cm, classes,\n","                          normalize=False,\n","                          title='Confusion matrix',\n","                          cmap=plt.cm.Blues):\n","    \"\"\"\n","    This function prints and plots the confusion matrix.\n","    Normalization can be applied by setting `normalize=True`.\n","    \"\"\"\n","    plt.imshow(cm, interpolation='nearest', cmap=cmap)\n","    plt.title(title)\n","    plt.colorbar()\n","    tick_marks = np.arange(len(classes))\n","    plt.xticks(tick_marks, classes, rotation=45)\n","    plt.yticks(tick_marks, classes)\n","\n","    if normalize:\n","        cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]\n","\n","    thresh = cm.max() / 2.\n","    for i, j in itertools.product(range(cm.shape[0]), range(cm.shape[1])):\n","        plt.text(j, i, cm[i, j],\n","                 horizontalalignment=\"center\",\n","                 color=\"white\" if cm[i, j] > thresh else \"black\")\n","\n","    plt.tight_layout()\n","    plt.ylabel('True label')\n","    plt.xlabel('Predicted label')\n","    \n","# Predict the values from the validation dataset\n","Y_pred = model.predict(x_val)\n","# Convert predictions classes to one hot vectors \n","Y_pred_classes = np.argmax(Y_pred,axis = 1) \n","# Convert validation observations to one hot vectors\n","Y_true = np.argmax(y_val,axis = 1) \n","# compute the confusion matrix\n","confusion_mtx = confusion_matrix(Y_true, Y_pred_classes) \n","# plot the confusion matrix\n","plot_confusion_matrix(confusion_mtx, classes = range(10)) "]},{"cell_type":"markdown","metadata":{"papermill":{"duration":3.388009,"end_time":"2022-02-25T15:03:13.39811","exception":false,"start_time":"2022-02-25T15:03:10.010101","status":"completed"},"tags":[]},"source":["## Prediction and generation of submission file ...\n"]},{"cell_type":"code","execution_count":13,"metadata":{"execution":{"iopub.execute_input":"2022-02-25T15:03:20.867863Z","iopub.status.busy":"2022-02-25T15:03:20.866909Z","iopub.status.idle":"2022-02-25T15:03:22.296858Z","shell.execute_reply":"2022-02-25T15:03:22.295795Z"},"papermill":{"duration":5.028375,"end_time":"2022-02-25T15:03:22.296977","exception":false,"start_time":"2022-02-25T15:03:17.268602","status":"completed"},"tags":[]},"outputs":[],"source":["# predict results\n","results = model.predict(test)\n","# select the indix with the maximum probability\n","results = np.argmax(results,axis = 1)\n","\n","results = pd.Series(results,name=\"Label\")\n","submission = pd.concat([pd.Series(range(1,28001),name = \"ImageId\"),results],axis = 1)\n","submission.to_csv(submission_path,index=False)"]},{"cell_type":"markdown","metadata":{"papermill":{"duration":3.424984,"end_time":"2022-02-25T15:03:29.128769","exception":false,"start_time":"2022-02-25T15:03:25.703785","status":"completed"},"tags":[]},"source":["# Upvote the Kernel "]}],"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.6"},"papermill":{"duration":803.372378,"end_time":"2022-02-25T15:03:33.002271","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2022-02-25T14:50:09.629893","version":"2.1.0"}},"nbformat":4,"nbformat_minor":4}